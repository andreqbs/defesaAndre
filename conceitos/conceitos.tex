\mychapter{Controle de Sistemas Sujeitos a Restrições}
\label{Cap_2}

Neste capítulo são apresentados alguns conceitos fundamentais para o desenvolvimento desta proposta. Inicialmente, serão relembradas algumas definições básicas associadas aos sistemas sujeitos a restrições. Em seguida, uma descrição sucinta sobre conjuntos invariantes controlados será apresentada, assim como, a sua aplicação em sistemas de controle. Por fim, serão apresentadas duas técnicas de otimização, que podem ser utilizadas em projetos de controle para sistemas lineares sujeitos a restrições.

\section{Sistemas Sujeitos a Restrições}

Na prática, todos os processos apresentam limitações físicas que normalmente devem ser respeitadas. Essas restrições podem estar nas variáveis controladas e manipuladas~\cite{Kwong:2013}.

As restrições normalmente surgem em problemas de controle de processo em decorrência das limitações físicas dos equipamentos, tais como, bombas, válvulas de controle, trocadores de calor, limites de operação, colocados para manter a segurança do processo, limite de emissão de poluentes e fatores econômicos que visam maximizar o lucro ou minimizar os custos~\cite{Roffel:2007}. 

Basicamente existem três tipos de restrições que atuam nos processos, que podem ser classificadas da seguinte forma:

\begin{itemize}
	\item \textbf{Restrições das Variáveis Manipuladas}: Estas são restrições rígidas nas entradas que devem ser satisfeitas (restrições de saturação das válvulas).
	
	\item \textbf{Restrições nas Taxas de Variação das Variáveis Manipuladas}: Estas são restrições rígidas nos movimentos das variáveis manipuladas, que influencia diretamente as taxas de variação destas variáveis.
	
	\item \textbf{Restrições nas Variáveis de Saída}: Estas são restrições rígidas ou maleáveis impostas na saída do sistema, que podem ser caracterizadas da seguinte forma:
	  \begin{itemize}
			\item Variáveis Controladas: Os limites para essas variáveis são especificados, mesmo que os desvios de seus \textit{setpoints} sejam minimizados na função objetivo.
		\end{itemize}
	  \begin{itemize}
			\item Variáveis Associadas: Não existe \textit{setpoint} para essas variáveis, mas elas devem ser mantidas dentro dos limites.
		\end{itemize}
\end{itemize}


\section{Sistemas Lineares Discretos em Equações de Estados}

Segundo~\citeasnoun{Longhi:2001}, a teoria de controle clássico se consolidou nas primeiras décadas do século XX. 

Em 1930 Hendrik Wade Bode e Harry Nyquist desenvolveram, nos laboratórios da companhia telefônica \textit{Bell}, os métodos de análise no domínio da frequência. Nos anos seguintes, W. R. Evans propôs o método do lugar das raízes no laboratório de radiação do \textit{Massachusetts Institute of Technology (M.I.T.)}.

As principais características do controle clássico é o uso de modelos matemáticos simples, que representam um sistema a ser controlado. Estes modelos matemáticos são normalmente representados por funções de transferência, que descrevem uma relação entre a entrada e a saída do sistema, sendo mais apropriados para sistemas lineares invariantes no tempo com uma única entrada e uma única saída (do inglês \textit{Single Input - Single Output (SISO)})~\cite{Nise:2002}.

Apesar de todas as contribuições obtidas ao longo dos anos, a abordagem clássica apresenta problemas de inadequação ao lidar com sistemas não lineares e multivariáveis. Contudo, em 1960 surgiu a teoria de controle moderno, com intuito de representar sistemas dinâmicos em modelos matemáticos com características mais complexas~\cite{Longhi:2001}.

A teoria de controle moderno passou a ser estudada, devido à possibilidade de utilizar computadores digitais para analisar sistemas mais complexos no domínio do tempo. Esta teoria é baseada na descrição de sistemas em equação de estados, que fornecem um modelo matemático amplo, podendo descrever não somente sistemas lineares, mas também sistemas não lineares, variantes no tempo, e com múltiplas entradas e múltiplas saídas~\cite{Lin:2007}. 
\newpage
A representação de um sistema linear por variáveis de estado é caracterizada como interna (estados), pois, além das variáveis de entrada e de saída, variáveis internas do sistema dinâmico também podem ser observadas. 

O sistema discreto linear e invariante no tempo em variáveis de estado pode ser representado da seguinte forma:

\begin{align}
   \nonumber x(k+1)&= Ax(k)+Bu(k)\\ 
   y(k)&= Cx(k)+Du(k)
\end{align}

$k$= 0, 1, 2, 3...,

Onde, 

$x(k) \rightarrow$ vetor de estados $\mathbb{R}^{n}$ (dimensão $n\times 1$);

$u(k) \rightarrow$ vetor de entradas ou vetor de controle $\mathbb{R}^{m}$ (dimensão $m\times 1$);

$y(k) \rightarrow$ vetor de saída $\mathbb{R}^{p}$ (dimensão $p\times 1$).

$A \rightarrow$ matriz de transmissão dos estados ($n\times n$);

$B \rightarrow$ matriz de entradas ($n\times m$);

$C \rightarrow$ matriz de saída ($p\times m$); 

$D \rightarrow$ matriz de alimentação direta ($p\times m$).

\subsection{Controle por Realimentação de Estados}

O controle por realimentação de estados surgiu na década de 60, quando a teoria de controle moderno passou a ser estuda. Atualmente, o controle por realimentação de estados é considerado um dos controladores mais utilizados em sistemas dinâmicos lineares, em que os estados de um sistema dinâmico formam um conjunto de variáveis que permitem a predição de um determinado sistema~\cite{Ogata:2010}.

O processo de controle por realimentação de estado requer que, todos os estados sejam mensuráveis com precisão, em todo tempo. A partir do acesso completo aos estados do sistema torna-se possível à implementação de uma lei de controle da seguinte forma~\cite{Dorf:2009}.

\begin{align}
u(k)=Kx(k)+r(k)
\end{align}

Onde $K$ é a matriz de ganho do controlador e $r$ é a referência de entrada.\\

Considerando a lei de controle por realimentação de estados no sistema descrito na equação 2.3, o sistema controlado é representado por:

\begin{align}
 \nonumber x(k+1)&= Ax(k)+B(K(x)+r(k))\\ 
                 x(k+1)&= (A+BK)x(k)+Br(k)
\end{align}

\section{Poliedros Positivamente Invariantes em Sistemas Lineares}

Na engenharia de controle, os sistemas lineares sujeitos a restrições nas variáveis de estado, controle e incertezas nos parâmetros são muito comuns. Estas restrições normalmente definem um conjunto poliédrico no espaço de estados, que, infelizmente, podem ser violadas, pois nem todas as trajetórias provenientes dos estados iniciais do poliedro permanecem no conjunto de restrições~\cite{Marques:1994}. Contudo, nos últimos anos, os projetos de sistemas de controle apresentaram um grande avanço através da utilização da teoria de poliedros positivamente invariantes, pertencentes ao espaço de estados como pode ser observado em ~\cite{Dorea:2009} e ~\cite{Araujo:2011}. 

O conjunto positivamente invariante tem a propriedade de que, para qualquer condição inicial pertencente ao conjunto, a trajetória dos estados de um sistema controlado permanecerá no interior do mesmo em todo o tempo, garantindo, assim, que as restrições do sistema não serão violadas~\cite{Nogueira:2009}.  

Considere um sistema linear, com um conjunto $\Omega$ de restrições aplicadas ao vetor de estados representado da seguinte forma:

\begin{align}
x(k+1)&= Ax(k)+Bu(k) 
\end{align}

Considere o vetor de controle $u(k)$ definido por:

\begin{align}
u(k) &= Kx(k)
\end{align}

Na ausência de perturbações, o sistema 2.4 pode ser representado da seguinte forma:

\begin{align}
	\nonumber x(k+1)&= Ax(k)+B(Kx(k))\\
	x(k+1)&= (A+BK)x(k)
\end{align}

Segundo \citeasnoun{Rocha:1994}, se $\Omega \subset \Re ^{n}$ é definido por um conjunto de restrições aplicado ao vetor de estados, $x \in \Omega$, e/ou $\mathcal{U} \in \Re^{m}$ é definido por um conjunto de restrições aplicado ao vetor de controle $u \in \mathcal{U}$, então o sistema 2.4 é um sistema sujeito a restrições nas variáveis de estados e controle. \\

Na teoria de conjuntos positivamente invariantes existem três definições importantes sobre os domínios particulares relativos ao sistema 2.4 que podem ser descritas da seguinte forma:\\

\textbf{Definição 2.1}: Um conjunto $\Omega \subset \mathbb{R}^{n}$ é um conjunto positivamente invariante com relação ao sistema descrito na equação 2.4 se, e somente se, $\forall x(0) \in \Omega\subseteq \mathbb{R}^{n}$, $x(k) \in \Omega$, para todo $k\geq 0$.\\  

\textbf{Definição 2.2}: Um  conjunto invariante $\Omega$ pode ser representado por poliedros convexos não vazios de $\mathbb{R}^{n}$ caracterizado por $R[G, \rho] = { x \in \mathbb{R}^{n}; Gx\leq \rho}$, onde  $G \in \mathbb{R}^{r\times n}$ é uma matriz e  $\rho \in \mathbb{R}^{r}$ um vetor, $r \in \mathbb{N}-\left \{ 0 \right \}, n \in \mathbb{N} -\left \{ 0 \right \}$. \\

\textbf{Definição 2.3}: Um conjunto não nulo e fechado, contendo a origem $\Omega$ é um conjunto $\lambda$-contrativo para o sistema descrito na equação 2.4 com $x \in \Omega$, se para um apropriado $\lambda \in [0,1]$, $x(k+1) \in \lambda \Omega$ $\forall x \in \Omega$. Se conjunto $\Omega$ é contrativo, então ele também é positivamente invariante, porém, a recíproca nem sempre é verdadeira.





%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\section{Conjunto Invariante Controlado}

Nesta seção, será apresentada, primeiramente, a importância de incluir nos projetos de controle a teoria de conjuntos invariantes. Em seguida, serão descritos alguns conceitos de conjuntos invariantes aplicados aos sistemas de controle sujeitos a restrições. Por fim, serão apresentados definições e teoremas relacionados à invariância controlada de poliedros convexos.  

\subsection{Características do Conjunto Invariante Controlado}

O conceito de conjunto invariante tornou-se importante nos projetos de controladores para sistemas dinâmicos sujeitos a restrições. A razão para utilizar este conceito está diretamente relacionada com a condição fundamental para manter a estabilidade do sistema e garantir que as restrições não serão violadas, independentemente da técnica adotada para solucionar o sistema de controle~\cite{Blanchini:2008}.

Considere o sistema linear discreto invariante no tempo representado por: 

\begin{align}
x(k+1) = A&x(k) + Bu(k)
\end{align}\

Onde, $k \in \mathbb{N}$, $x \in \mathbb{R}^n$ é o vetor de estados e $u \in \mathbb{R}^m$ é o vetor de controle. \\

\textbf {Teorema 2.1}: As restrições impostas ao sistema dinâmico, da equação 2.7, podem ser satisfeitas em todo o tempo se, e somente se, a condição inicial $x(0)$ estiver contida em um conjunto invariante.\\

\textbf {Definição 2.4}: Um conjunto não-vazio, fechado $\Omega \subset R^{n}$ é invariante controlado com relação ao sistema apresentado na equação 2.7, se:
\begin{align}
\nonumber \exists u\in R^{m}:Ax(k)+Bu(k) \in \Omega, \forall x \in \Omega
\end{align}

Segundo~\citeasnoun{Dorea:1999}, a definição 2.4 mostra, que o conjunto de restrições é um conjunto invariante controlado se, $\forall x(0) \in \Omega$, existe uma sequência de controle $u(k)$ ($k \in \textit{N}$), que mantém a trajetória do vetor de estados completamente no conjunto $\Omega$.\\

\textbf {Definição 2.5}: O conjunto admissível a um passo para $\Omega$ é definido da seguinte maneira:
\begin{align}
\nonumber \mathfrak{L}(\Omega)= \left \{ x \in \Re ^{n}: \exists u \in \Re ^{m}: Ax+Bu \in \Omega \right \}
\end{align}

Onde, $\mathfrak{L}(\Omega)$ é o conjunto de todos os estados que podem ser transferidos em um passo para o conjunto $\Omega$. \\

\textbf {Teorema 2.2}: O conjunto $\Omega\subset\mathbb{R}^n$ é um conjunto invariante controlado, se e somente se, a seguinte condição geométrica  for satisfeita:
\begin{align}
\nonumber \Omega \subseteq \mathfrak{L}(\Omega)
\end{align}

\subsubsection{Invariância Controlada de Poliedros Convexos para Sistemas Lineares}

Recentemente, as técnicas de cálculos geométricos, associadas aos poliedros convexos, têm sido objeto de estudo nas diferentes áreas de pesquisa~\cite{Dorea:1999},~\cite{Pimenta:2005},~\cite{Alessio:2009},~\cite{Araujo:2010} e~\cite{Araujo:2011}. Estes poliedros são frequentemente utilizados em problemas de programação matemática, geometria computacional, estatística, ciência dos materiais e engenharia de controle. Em sistemas de controle, as expressões naturais de restrições físicas nos estados e na variável de controle definem os conjuntos poliédricos convexos.

Um conjunto poliédrico convexo, contendo a origem, pode ser representado da seguinte maneira:

\begin{align}
\Omega= R[G, \rho]=\left \{ x:Gx\leq \rho \right \},\  \rho\geq 0
\end{align}\

Para um dado tempo $k$, a admissibilidade do vetor de estados no momento $k+1$, utilizando o sistema descrito da equação 2.7, é caracterizado pelo seguinte conjunto de restrições:

\begin{align}
Gx(k)\leq \rho \mapsto Gx(k+1)\leq \rho
\end{align}

Considerando, 
\begin{align}
x(k+1) = A&x(k) + Bu(k)
\end{align}\

Substituindo 2.10 em 2.9, temos um conjunto de restrições que define um poliedro convexo, que pode representar um conjunto admissível a um passo para $\Omega$ da seguinte forma:

\begin{align}
GAx(k)+GBu(k)\leq \rho
\end{align}

\subsubsection{Conjunto Invariante Controlado $\lambda$-Contrativo}

%Os conjuntos contrativos podem ser associados aos conjuntos invariantes controlados, onde a sua principal característica é encontrar um conjunto em que o controle admissível exista, garantindo que, no próximo passo, o estado esteja contido em um subconjunto do conjunto original~\cite{Kerrigan:2000}

A contratividade de um conjunto invariante controlado é representada por uma taxa de convergência $\lambda$. Esta taxa determina a convergência da trajetória do sistema ao ponto de equilíbrio $x^{*}$, auxiliando sistemas afetados por perturbações e incertezas~\cite{Kirk:2004}.\\

\textbf {Definição 2.6}: Um conjunto fehado $\Omega \subset \Re^{n}$ é dito invariante controlado $\lambda$-contrativo com $0 < \lambda\leq 1$, se:

\begin{align}
	\exists u \in R^{n}:Ax+Bu \in \lambda \Omega,\forall x \in \Omega 
\end{align}

As condições de invariância controlada apresentadas anteriormente, para admissibilidade a um passo, podem ser caracterizadas para a condição de um conjunto invariante contrativo$-\lambda$ controlado da seguinte forma:

\begin{align}
GA(k)+GBu(k)\leq \lambda\rho
\end{align}

\subsubsection{O Máximo Conjunto Invariante Controlado}

Normalmente, as restrições impostas aos sistemas dinâmicos discretos podem ser representadas por um conjunto de restrições $\Omega$. No entanto, este conjunto não apresenta as mesmas características dos conjuntos invariantes controlados, ou seja, $\forall x(0) \in \Omega$, não existe uma sequência de controle $u(k)$ ($k \in \textit{N}$), que mantém a trajetória do vetor de estados completamente no conjunto $\Omega$~\cite{Kerrigan:2000}. Este problema pode ser solucionado a partir do algoritmo proposto por~\citeasnoun{Dorea:1999}, onde inicialmente é determinado um conjunto admissível para o qual as restrições são satisfeitas no instante $x(k+1)$. Em seguida, é verificada uma condição geométrica, descrita pelo lema estendido de Farkas, onde, a partir da interseção entre os dois conjuntos, um novo conjunto de restrições é obtido. Estes passos são realizados até a convergência para o máximo conjunto invariante controlado, que possui as seguintes propriedades:

\textbf{Proposição 2.1}: A família de todos os conjuntos invariantes controlados contidos em um conjunto convexo $\Omega$ é fechado em relação à operação envelope convexo. Esta proposição garante a existência de um elemento máximo que contém todos os outros elementos na família de conjuntos invariantes controlados contidos no conjunto de restrições $\Omega$.

\begin{center}
$C^{\infty}(\Omega)$ $\triangleq$ máximo conjunto invariante controlado contido em $\Omega$
\end{center}

\textbf{Definição 2.7}: O conjunto máximo $C^{\infty}(\Omega)$ contido no conjunto de restrições $\Omega$ é o conjunto de estados para os quais existe uma sequência de controle ótima capaz de mantê-los em $\Omega$ em $i$ passos.

O máximo conjunto pode ser caracterizado pela seguinte formula ~\cite{Dorea:1999}:

\begin{align}
C^{i+1}=\mathfrak{L}(C^{i})&\cap C^{i}, com\ C^{0}=\Omega\\
C^{\infty}(\Omega)&=\lim_{i\rightarrow\infty}C^{i}
\end{align}

O máximo conjunto invariante controlado pode ser adaptado para um conjunto com uma taxa de contração $\lambda$, representado da seguinte maneira:
 
\begin{center}
$C^{\infty}(\Omega, \lambda)$ $\triangleq$ máximo conjunto invariante controlado  contido em $\Omega$
\end{center}

Introduzindo a taxa de contração no máximo conjunto invariante controlado, temos:

\begin{align}
C^{i+1}=\mathfrak{L}( \lambda C^{i})&\cap C^{i}, com\ C^{0}=\Omega\\
C^{\infty,\lambda }(\Omega)&=\lim_{i\rightarrow \infty }C^{i}
\end{align} 

\textbf{Exemplo Numérico 2.1}: 

Considere o sistema linear sujeito a restrições descrito por~\cite{Dorea:1999} da seguinte forma:

\begin{align}
x(k+1)=Ax(k)+Bu(k)
\end{align}

Onde, $x(k) \in \mathbb{R}^2$, $u(k) \in \mathbb{R}$ $k \in \mathbb{N}$, 
\begin{align*}
A=
\begin{bmatrix}
0,4 & 0,9\\ 
 0,6& 1,8
\end{bmatrix};
B=
\begin{bmatrix}
0\\1 
\end{bmatrix}
\end{align*}

A taxa de contratividade pré-estabelecida é  $\lambda=0.8$ e as restrições do sistema são representadas por um poliedro $R [G,\rho]$.

Onde,

\begin{align*}
G=
\begin{bmatrix}
0,2 & 0,2\\ 
 -1& -1\\ 
 -1& 0,35\\ 
 0,25& -0,5
\end{bmatrix},
\rho=
\begin{bmatrix}
1\\ 
1\\ 
1\\ 
1\\
\end{bmatrix}
\end{align*}

A figura \ref{fig:resp1} ilustra um conjunto poliédrico $R[G,\rho]$, que representa um conjunto de restrições. Neste exemplo, o conjunto de restrições não é invariante em relação ao sistema descrito na equação 2.18. Portanto, não existe sequência de controle que mantenha a trajetória do vetor de estados sob as restrições. Contudo, com aplicação do algoritmo proposto por~\citeasnoun{Dorea:1999}, mencionado anteriormente, é possível encontrar o máximo conjunto invariante controlado representado por $R[G_{f},\rho_{f}]$. Este conjunto garante que $\forall x(k) \in R[G_{f},\rho_{f}]$ existe uma sequência de controle, que conserva a trajetória do vetor de estados em $R[G_{f},\rho_{f}]$.

\begin{figure}[H] 
\begin{center}
\caption{Conjunto Poliédrico Invariante Controlado $C^{\infty }(R[G_{f},\rho_{f}],\lambda)$}
	\includegraphics[scale=0.5]{imagens/invariant_set1.png}
	\label{fig:resp1}
\end{center} 
\end{figure}


%----------------------------------------------------------------------------------------------------%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%------------------------------------------------------------------------------------------------------------------------------------------------------------

\section{Projetos de Controlador Para Sistemas Lineares Sob Restrições}

Esta seção tem como objetivo principal apresentar duas técnicas de otimização que podem ser utilizadas para determinar uma sequência de controle capaz de manter a dinâmica do sistema, descrito na equação 2.18, sob o conjunto de restrições $R[G_{f},\rho_{f}]$. Primeiramente, será apresentada a técnica de programação linear, que determina uma a ação de controle \textit{on-line}. Em seguida, será apresentada a técnica de programação multiparamétrica em controle de sistemas lineares sujeitos a restrições, e a sua influência no controle preditivo baseado em modelo. Por fim, serão estabelecidas as vantagens e desvantagens de utilizar estas técnicas de otimização em projetos de controle para sistemas lineares sob restrições.

\subsection{Controle de Sistemas Sujeitos a Restrições Usando Programação Linear}

A programação linear é uma técnica de otimização bastante utilizada nos projetos de controle para sistemas lineares sujeitos a restrições, pois determina soluções ótimas a cada instante de tempo (\textit{on-line}) para o controle do sistema satisfazendo as restrições exigidas.

\subsubsection{Programação Linear}

O termo programação linear (do inglês \textit{Linear Programming} (LP)), descreve uma ampla e importante classe de problemas de otimização que envolvem uma função objetivo linear nas incógnitas, e restrições que consistem em equações e inequações lineares~\cite{Karloff:2008}.

A programação linear foi apresentada, primeiramente, por Leonid Kantarovich em 1939, mas o seu grande desenvolvimento aconteceu durante a segunda guerra mundial, e nos anos seguintes, devido a necessidade de investigar a melhor forma de tomar decisões na gestão dos recursos e, nas operações das forças armadas~\cite{Carvalho:2014}. Desde então, a programação linear vem sendo utilizada para tomadas de decisões gerenciais importantes em diferentes áreas da engenharia, objetivando minimizar ou maximizar um determinado custo sujeito a restrições~\cite{Dantzig:2003}. 

%Recentemente, a programação linear passou a ser aplicada em refinarias de petróleo, com o objetivo de auxiliar os engenheiros químicos a determinar uma mistura de petróleo a ser enviada para uma torre de craqueamento e, assim, produzir os seus derivados. Este procedimento, na maioria dos casos, é realizado com um custo mínimo, sob restrições na operação das plantas químicas industriais~\cite{Kwong:2013}.

Segundo~\citeasnoun{Gass:2003}, a programação linear pode ser definida como um problema de maximização ou minimização de uma função linear sujeita a restrições lineares, que são representas por equações e inequações lineares da seguinte forma:

\begin{align*}
	Minimizar (Maximizar) f(x_{1},x_{2}, \cdots, x_{n})= c_{1}x_{1}+c_{2}x_{2}+\cdots c_{n}x_{n}\\
\end{align*}
Sujeito a;
\begin{align*}
	a_{11}x_{1}+a_{12}x_{2}+\cdots+ a_{1n}x_{n}\left\{ \le,=,\geq\right\}b_{1}\\
	a_{21}x_{1}+a_{22}x_{2}+\cdots+ a_{2n}x_{n}\left\{ \leq,=,\geq\right\}b_{2}\\
	\vdots \\
	a_{m1}x_{1}+a_{m2}x_{2}+\cdots+ a_{mn}x_{n}\left\{ \leq,=,\geq\right\}b_{m}\\
	x_{1}, x_{2}, \cdots, x_{n} \geq 0\\
\end{align*}

Onde,

$a_{ij}(i=1,\cdots, m ; j=1, \cdots, n)$ são os coeficientes;

$b_{1}, b_{2}, \cdots, b_{m}$ são os termos independentes (constantes de restrições);

$c_{1}, c_{2}, \cdots, c_{n}$ são os coeficientes da função objetivo;

$x_{1}, x_{2}, \cdots, x_{n}$ são as variáveis de decisão.

\subsubsection{Cálculo da Ação de Controle \textit{On-line}}

Os sistemas lineares sujeitos a restrições nas variáveis de estados e controle podem ser controlados por ações de controle \textit{on-line} $u(k)$ que satisfaçam as restrições. Estas ações são normalmente obtidas a partir da solução de um problema de programação linear, que possui a seguinte formulação matemática:

\begin{align}
\nonumber 
Minimize (Maximizar)\   f(x) = c^{T}x\\
Sujeito\ a: Ax\leq b\\
 \nonumber x\geq 0
\end{align}

A expressão a ser minimizada, no problema matemático da equação 2.19, é a função objetivo $f(x)$, e as desigualdades $Ax\leq b$ e $x\geq 0$ são as restrições lineares, que geometricamente especificam um poliedro convexo, sobre o qual a função objetivo é minimizada ou maximizada.

A ação de controle \textit{on-line} ($u(k)$) é determina após o problema de programação linear ser solucionado no instante $k$. Logo em seguida, no mesmo instante $k$ a ação de controle pode ser aplicada ao sistema sem violar as restrições, como descreve o exemplo numérico 2.2

\subsubsection{Exemplo Numérico 2.2}

O controle por realimentação de estados do sistema sujeito a restrições apresentado no exemplo numérico 2.1 pode ser realizado utilizando a técnica de programação linear com o problema matemático representado da seguinte maneira:

\begin{align}
\nonumber Minimize:\varepsilon =\begin{bmatrix}
0 & 1
\end{bmatrix}
\begin{bmatrix}
u(k)\\\varepsilon  
\end{bmatrix}
\end{align}
\begin{align}
Sujeito\ a: 
\begin{bmatrix}
G_{f}B & -\rho
\end{bmatrix}
\begin{bmatrix}
u(k)\\ \varepsilon 
\end{bmatrix}
&\leq -G_{f}Ax(k)
\end{align}

\begin{align}
\begin{bmatrix}
\nonumber  U & 0
\end{bmatrix}
\begin{bmatrix}
u(k)\\ \varepsilon 
\end{bmatrix}
&\leq \varphi 
\end{align}

Onde, as variáveis $\varepsilon$ e $u(k)$ representam respectivamente a taxa de contração que deve ser minimizada e a ação de controle para o instante $k$, que deve satisfazer as restrições nas variáveis de estado e, também a restrição na variável de controle representada da seguinte forma:

\begin{align}
Uu(k)\leq \varphi 
\end{align}
Onde,
\begin{align}
\nonumber \varphi=\begin{bmatrix}
10\\ 10
\end{bmatrix}, \nonumber U=\begin{bmatrix}
1\\ -1
\end{bmatrix}
\end{align}\\

\newpage

A solução do problema matemático, descrito na equação 2.20, pode ser obtida a partir da função \textit{Linprog} do \textit{software} Matlab$^\circledR$. Este método permite encontrar uma solução ótima de $u(k)$ a cada iteração de forma a minimizar $\varepsilon$, satisfazendo as restrições. A partir desta solução a dinâmica do sistema pode ser controlada, como mostra a figura \ref{fig:resp2}.

 \begin{figure}[H] 
\begin{center}
	\caption{Trajetória do vetor de estados}
	\includegraphics[scale=0.6]{imagens/294.png}
	\label{fig:resp2}
\end{center} 
\end{figure}

A figura \ref{fig:resp2} descreve a trajetória do vetor de estados, obtida através do valor de $u(k)$, via programação linear, com condição inicial $x(0)=[0,3910; 3,9744]^{T}$. A partir desta figura é possível observar que a trajetória do vetor de estados está convergindo para origem e contida completamente no conjunto $R[G_{f},\rho_{f}]$, confirmando, assim, que existe uma sequência de controle que mantém a trajetória do vetor de estados contida completamente em $R[G_{f}, \rho_{f}]$, ou seja, o conjunto de restrições $R[G_{f}, \rho_{f}]$ é positivamente invariante sob a solução \textit{on-line}.

Apesar das diversas contribuições da técnica de programação linear (LP) em sistemas de controle sob restrições, existem desvantagens significativas quando se trata do elevado tempo computacional exigido em sistemas mais complexos (caracterizados por apresentar perturbações ou um número maior de variáveis). Este elevado tempo computacional ocorre devido aos repetitivos cálculos para encontrar a solução ótima do problema sob restrições, tornando, assim, a programação linear inadequada para o controle de processos, que necessitam de tomadas de decisões rápidas~\cite{Zeilinger:2011}.

%------------------------------------------------------------------------------------------------------------------------------------------------------------
%------------------------------------------------------------------------------------------------------------------------------------------------------------
%------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection {Controle de Sistemas Sujeitos a Restrições Usando Programação Multiparamétrica}

A programação multiparamétrica é uma ferramenta importante de otimização, que analisa sistematicamente o efeito de incertezas e variabilidade em problemas de programação matemática~\cite{Filippi:2004}. Esta ferramenta soluciona um problema matemático que depende de um vetor de parâmetros, que podem aparecer na função custo e nas restrições~\cite{Borrelli:2003}.

Em problemas de otimização, a técnica de programação multiparamétrica pode ser utilizada para resolver qualquer problema de otimização. Esta técnica tem como objetivo minimizar ou maximizar um critério de desempenho sujeito a um determinado conjunto de restrições, onde alguns dos parâmetros variam entre os limites inferiores e superiores específicos~\cite{Sakizlis:2007}.
 
A principal característica da programação multiparamétrica para otimização é a sua capacidade de, sistematicamente, subdividir um espaço de parâmetros em regiões características (RC), onde o valor ideal e o otimizador são expressos como funções explícitas dos parâmetros. Portanto, a tomada de decisão é realizada a partir de um mapa completo de resultados possíveis~\cite{Bemporad:2002}, como mostra a figura 2.3.

 \begin{figure}[H] 
\begin{center}
\caption{Regiões características.}
	\includegraphics[scale=0.5]{imagens/294.png}%melhorar figura
	\label{fig:res1}
\end{center} 
\end{figure}

A Programação multiparamétrica pode ser aplicada em diversas áreas~\cite{Pistikopoulos:1997} tais como:
\begin{itemize}
\item 
Planejamento de processos sob incertezas;
\item  
Concepção de materiais sob incertezas;
\item 
Otimização multi-objetivo;
\item 
Análise de flexibilidade;
\item 
Cálculo de probabilidades normais multivariadas singulares;
\item 
Controle preditivo baseado em modelo;
\item 
Controle explícito baseado em programação multiparamétrica
\end{itemize} 

\subsubsection{Solução do Problema de Programação Linear Multiparamétrica}

O primeiro método desenvolvido para solucionar os problemas de programação multiparamétrica linear foi formulado por~\citeasnoun{Gal:1972}, e somente depois de alguns anos os autores~\citeasnoun{Fiacco:1976},~\citeasnoun{McBride:1980} e~\citeasnoun{Geoffrion:1977}, apresentaram interesse na solução de problemas de programação multiparamétrica não-lineares, quadráticas e inteiras. No entanto, apesar dos maiores avanços nos problemas de programação multiparamétrica, existem ainda pesquisas direcionadas apenas para o desenvolvimento de algoritmos de programação muiltiparamétrica linear, devido às diversas aplicações em sistemas dinâmicos lineares~\cite{Pistikopoulos:2012a}

\subsubsection{Algoritmo de Programação Linear Multiparamétrica }

O algoritmo de programação linear multiparamétrica (do inglês \textit{multi-parametric linear programming} (mp-LP)) proposto por~\citeasnoun{Borrelli:2003} é um algoritmo iterativo, que utiliza argumentos geométricos ao explorar diretamente o espaço de parâmetros ao invés de visitar diferentes bases do programa linear associado. Este algoritmo possui vantagens computacionais na sua implementação, pois apresenta simplicidade e a possibilidade de procurar as soluções paramétricas dentro de um dada região poliédrica do espaço de parâmetros, sem solucionar o problema para todo $x \in R_{n}$ ~\cite{Neves:2013}. Este algoritmo descreve o seguinte problema matemático:

\begin{align}
\nonumber J(x) = \underset{v}{min}\  c^{T}v + d^{T}x\\
 Sujeito\ a:  Av\leq b+Ex
\end{align}\

Onde, $x \in \mathbb{R}^{n}$, $v \in \mathbb{R}^{p}$, $A \in \mathbb{R}^{m\times p}$, $b\in \mathbb{R}^{m}$, $E\in \mathbb{R}^{m\times n}$, $c \in \mathbb{R}^{p}$ e $d \in \mathbb{R}^{n}$.\\

\newpage

Para obter uma melhor compreensão de como a solução do mp-LP é caracterizada, algumas definições devem ser abordadas~\cite{Bemporad:2006}:\\

\textbf {Definição 2.8} (Conjunto Factível): Define-se um conjunto factível $X \subset \mathbb{R}^{n}$ como o conjunto de parâmetros $x \in \mathbb{R}^{n}$ para o qual o problema de otimização (2.22) é factível. Em outras palavras:\
\begin{align}
\nonumber X = { x \in \mathbb{R}^{n}|  Av\leq b+Ex}
\end{align}\

\textbf {Definição 2.9} (Partição Poliédrica): Uma coleção de conjuntos poliédricos $\left \{ R_{i} \right \}_{i=1}^{R} = \left \{ R_{1}, \cdots , R_{N} \right \}$ é a partição poliédrica de um conjunto poliédrico $X$ se, \

\begin{align}
\nonumber \left\{\begin{matrix}
\left \{ u_{i} \right \}_{i=1}^{N}R_{i}& = & X\\ 
(R_{i}/\partial R_{i})\ \cap (R{q}/\partial R_{q}) &=& \varnothing ,\forall i \neq q
\end{matrix}\right.
\end{align}

Onde, $\partial$ significa a fronteira.\\

\textbf {Definição 2.10} (Função Afim por Partes ou \textit{Piecewise-Affine Function (PWA)}): Uma função $u : x\rightarrow \mathbb{R}^d$ com $d \in \mathbb{N}_{+}$ é afim por partes, se a partição $\left \{ R_{i} \right \}_{r =1}^N$ de um conjunto $X$ existir, como:\
\begin{align} 
\nonumber u(x)= F_{i}x+g_{i}\ se\ x \in R_{i}
\end{align}

\textbf {Teorema 2.3} Considere o problema de programação linear multiparamétrica apresentado na equação 2.22~\cite{Borrelli:2003}:\

\begin{enumerate}

\item O conjunto de parâmetros factíveis $X$ é um poliedro convexo.\

\item O conjunto $X$ é particionado em $i$ regiões poliedrais, i. e.:\
\begin{align*} 
	R_{i}=\left\{x\in\mathbb{R}^{n}|H_{i}x\leq z_{i}\right\}
\end{align*}

\item A solução ótima $u:X\rightarrow \mathbb{R}^q$ é uma função afim por partes em relação ao parâmetro $x$, i. e.:\
\begin{align*}
	u(x)= F_{i}x+g_{i}\ se\ x \in R_{i}
\end{align*}\

\item A função de custo ótima $J:X\rightarrow \mathbb{R}$ é contínua, convexa e afim por partes, i. e.:\
\begin{align*}
	J(x)= B_{i}x+C_{i}\ se\ x \in R_{i}; 
\end{align*}\
\end{enumerate}

A grande vantagem das propriedades apresentadas no teorema 2.3 é que a solução ótima é definida avaliando a função explícita PWA para um valor conhecido de $x$, o que envolve os seguintes passos:\

\begin{enumerate}
\item Observar o estado atual ($x$) do sistema; 
\item Identificar a região $R_{i}$ que contém $x$;\
\item Avaliar a respectiva função $u(x)$ afim por partes.
 \end{enumerate}

O total de cálculos necessários para realizar as operações nos passos 1, 2 e 3 é igual ao número total de partições $R_{i}$ de um conjunto $X$. Portanto, a complexidade computacional do algoritmo mp-LP está relacionada diretamente aos cálculos (\textit{off-line}) da solução ótima e a capacidade de armazenamento da solução~\cite{Weinkeller:2012}.

\subsubsection{Programação Linear Multiparamétrica em Controle de Sistemas}

O método de programação multiparamétrica surgiu nas últimas décadas como uma técnica importante para a solução de problemas, de otimização. Este método é bastante reconhecido, e muitos avanços significativos foram estabelecidos, tanto na teoria, quanto na aplicação em problemas de engenharia~\cite{Pistikopoulos:2012b}.

A programação multiparamétrica possui um reconhecimento generalizado na área de controle, pois permite substituir os métodos de otimização existentes por cálculos simples e eficientes~\cite{Pistikopoulos:2012a}. 

Recentemente, vários projetos de controle e métodos resultantes em estrutura de controle têm sido desenvolvidos a partir do método de programação multiparamétrica, com o intuito de controlar os sistemas lineares sujeitos a restrições nas variáveis de estado e controle~\cite{Johansen:2007}. 

A programação multiparamétrica, quando aplicada ao projeto de controle por realimentação de estados, tem como objetivo principal determinar ações de controle explicitamente, ou seja, antes do sistema estar em operação já serão conhecidos todos os valores de ações de controle, estabelecidas de forma \textit{off-line}~\cite{Neves:2013}. Esta ação de controle pode ser obtida a partir do algoritmo de otimização mp-LP.

Segundo~\citeasnoun{Bemporad:2002}, a solução do algoritmo mp-LP, assume a forma de uma lei de controle por realimentação de estados PWA, que pode ser representa  da seguinte forma:

\begin{align} 
u(x(k))\left\{\begin{matrix}
u_{1}= & K_{1}x(k)+g_{1}  & Se\ x(k)\in R_{1} \\
\vdots & \vdots & \vdots\\  
u_{i}= & K_{i}x(k)+g_{i}  & Se\ x(k)\in R_{i}
\end{matrix}\right.
\end{align}

Onde, $x$ é o estado do sistema observado, que atua como entrada para a função de controle. As matrizes $K_{i}$ e os vetores $g_{i}$ definem uma realimentação fixa, e uma mudança constante para uma dada lei de controle. O estado atual medido representa uma parte de uma região poliédrica $ R_{i}$, a soma destes conjuntos forma uma partição de poliedros $\Omega = R_{1}, R_{2}, R_{3}, ..., R_{i}$ no espaço de estados. Segundo~\citeasnoun{Rohal:2013}, os conjuntos poliédricos $R_{i}$ são caracterizados da seguinte forma:\

\begin{align} 
R_{i}=\left \{ x \in  \mathbb{R}^{n} | A_{R_{i}}x\leq b_{R_{i}}\right \}
\end{align}


\subsubsection{Exemplo Numérico 2.3}

O controle por realimentação de estados do sistema apresentado no exemplo numérico 2.1 pode ser realizado a partir da solução de um problema de programação de linear multiparamétrica utilizando a função mp-LP do pacote MPT para \textit{software} Matlab$^\circledR$ desenvolvido no ETH-Zurich~\cite{Kvasnica:2004}. Esta função permite subdividir o máximo conjunto invariante controlado em $n$ regiões poliédricas com suas respectivas leis de controle explícitas PWA.

O problema matemático da programação multiparamétrica, para o exemplo numérico 2.1 apresenta a seguinte formulação:

\begin{align}
\nonumber V(x)=\underset{u}{min}\ Hu
\end{align}
\begin{align}
Sujeito a:
\nonumber Gu\leq w+Ex\\
bndAx\leq bndb
\end{align}

Onde,

\begin{align}
\nonumber H=
\begin{bmatrix}
0 &1 
\end{bmatrix}, \nonumber G=
\begin{bmatrix}
G_{f}B &-\rho \
 U& 0
\end{bmatrix}, \nonumber E=
\begin{bmatrix}
G_{f}Ax(k)\\ 0
\end{bmatrix}
\end{align}\
\begin{align}
\nonumber w = 
\begin{bmatrix}
0\\ \varphi 
\end{bmatrix}, \nonumber 
U =\begin{bmatrix}
1\\ -1
\end{bmatrix}
\end{align}
\begin{align}
\nonumber bndAx &= G_{f}x\\
\nonumber bndb &= \rho 
\end{align}\


Para o exemplo numérico 2.1 a função mp-LP subdividiu o máximo conjunto invariante controlado, em duas regiões poliédricas ($R_{1}, R_{2}$) e determinou suas respectivas leis de controle explícitas em função dos estados do sistema, apresentado na equação 2.18, como mostra a figura 2.4


 \begin{figure}[H] 
\begin{center}
\caption{Regiões Poliédricas e uma trajetória do vetor de estados (Solução \textit{Off-line}).}
	\includegraphics[scale=0.6]{imagens/294.png}%melhorar figura
	\label{fig:resp3}
\end{center} 
\end{figure}

Cada região tem uma lei de controle explícita da seguinte forma: 

\begin{table} [H]
\caption{Solução do problema de programação linear multiparamétrica}
\label{tab1}
\begin{center}
\begin{tabular}{|c|c|} 
\hline
	Região Poliédrica $R_{i}=H_{i}x \leq z_{i}$ &  $u(x)=F_{i}x(k)+g_{i}$\\ 
	\hline
	$Se\  x(k) \in R_{1}$ & $[-0,5714   -1,7357]x(k) + 0$\\  	

	$Se\  x(k) \in R_{2}$ & $[-0,6000   -1,8000]x(k) + 0$\\
	\hline
\end{tabular}
\end{center}
\end{table}

Na figura 2.5 também é apresentada a trajetória do vetor de estados do sistema convergindo para origem, com mesma condição inicial do exemplo numérico anterior. Esta trajetória foi obtida a partir da solução \textit{off-line}, onde a cada instante de tempo ($k$)foi localizada a região $R_{i}$ do estado $x(k)$ e lei de controle explícita PWA $u(x)$, como mostrada na tabela 2.1.


\subsubsection{Programação Multiparamétrica em Controle Preditivo}

%Os sistemas lineares sujeitos a restrições nas variáveis de estados e/ou controle são reconhecidos como os mais importantes na classe de sistemas práticos, devido as decorrentes limitações físicas dos processos industriais. A partir disso, vários projetos de controle foram desenvolvidos para sistemas lineares sujeitos a restrições, como, por exemplo, o controle preditivo baseado em modelo.

O controle preditivo baseado em modelo \textit{(Predictive Control Model - MPC)} é uma técnica bem conhecida, amplamente usada nos processos industriais para a regulação automática de plantas industriais sob restrições operacionais~\cite{Camacho:2007}. A tecnologia do controlador MPC foi originalmente desenvolvida para usinas e aplicações de controle em refinaria de petróleo, mas atualmente pode ser encontrada em uma grande variedade de ambientes de produção, incluindo produtos químicos, processamento de alimentos, automotivos e aeroespaciais~\cite{Kouvaritakis:2001}.  

Tradicionalmente, na estratégia clássica do controlador MPC, as entradas futuras são obtidas a partir de um processo de otimização realizado a todo instante \textit{(on-line)}, que leva em consideração uma função custo e as restrições específicas do sistema~\cite{Pistikopoulos:2012b}.

%, como ilustra a figura 2.5.
%
 %\begin{figure}[H] 
%\begin{center}
%\caption{Controle preditivo clássico (KIDO, 2011).}
	%\includegraphics[scale=0.7]{imagens/08.png}%melhorar figura
	%\label{fig:res1}
%\end{center} 
%\end{figure}

Apesar das vantagens do MPC ao lidar com restrições, sua aplicação tem sido bastante limitada, devido aos requisitos computacionais existentes na otimização \textit{on-line}~\cite{Pistikopoulos:2012a}.

Os métodos de otimização \textit{on-line}, atualmente utilizados nos controladores MPC, realizam todos os cálculos a cada instante de tempo. Este procedimento, geralmente, para uma quantidade maior de entradas, saídas e restrições mais complexas, torna o uso do controlador MPC inviável para sistemas dinâmicos rápidos, como, por exemplo, sistemas embarcados encontrados na robótica e aeronáutica\cite{Weinkeller:2008}.

Ao observar, os problemas provenientes do controle MPC com otimização \textit{on-line}, surgiu, nos últimos anos, um interesse em aplicar o método de programação multiparamétrica ao controle preditivo baseado em modelo, tornando-o comumente conhecido como controle MPC explícito~\cite{Sakizlis:2007}. Este controle é considerado um tipo de controle "avançado", que realiza de maneira \textit{off-line} um mapeamento exato das variáveis de controle ótimas em função das variáveis de estado do sistema~\cite{Kouramas:2011}.  

O problema do controlador MPC pode ser formulado como um problema de programação multiparamétrica da seguinte forma:

\begin{align}
\nonumber u^{*}(x)=\underset{u}{min}\ Y^{T}u\\
Sujeito\ a:\ Gu\leq W+Ex
\end{align}

Onde, G, W, E, H e Y são matrizes que podem ser observadas com mais detalhes em ~\citeasnoun{Bemporad:2002}.\\


%O procedimento do controle MPC explícito em sistemas dinâmicos é realizado a partir das leis de controle explícitas pré-calculadas pela solução multiparamétrica. Neste procedimento os parâmetros estão contidos em uma região, bem definida, no espaço de estados (na forma de restrições), a qual uma lei de controle por realimentação de estados PWA está associada (KIDO, 2011), como mostra a figura 2.6.

%\begin{figure}[H] 
%\begin{center}
%\caption{Controle preditivo via programação multiparamétrica (KIDO, 2011)}
	%\includegraphics[scale=0.7]{imagens/09.png}%melhorar figura	
	%\label{fig:res1}
%\end{center} 
%\end{figure}

A principal vantagem de utilizar a programação multiparamétrica no controle MPC é a possibilidade de substituir os cálculos repetitivos da otimização \textit{on-line} do MPC por um simples cálculo das funções explícitas (\textit{off-line}). Além disso, os valores factíveis de ações de controle podem ser armazenados, trazendo agilidade para o controle preditivo e um menor custo computacional ao realizar o controle de processos~\cite{Pistikopoulos:2012b}.

Segundo~\citeasnoun{Pistikopoulos:2012a}, a programação multiparamétrica tem auxiliado o controle MPC em diversas aplicações importantes. Muitas dessas aplicações envolvem projetos e implementações em processos reais, onde os \textit{hardware} e \textit{software} de controle disponíveis são limitados para aplicações de controle avançado. 

As principais áreas de aplicação do controle MPC explícito incluem, engenharia de processos, sistemas biológicos, sistemas embarcados (robótica), gestão de resíduos, separação gás-liquido e processos de petróleo e gás. 

No entanto, apesar de todas as vantagens oferecidas pela programação multiparamétrica em sistemas de controle, a técnica apresenta desvantagens que devem ser levadas em consideração, quando se trata do custo computacional \textit{off-line} e os requisitos de memória, pois, dependendo da complexidade do sistema, a capacidade da memória disponível torna-se insuficiente com o aumento do número de regiões factíveis. 


\section{Considerações Finais}

O capítulo 2 teve como objetivo apresentar conceitos e definições sobre assuntos fundamentais para o desenvolvimento deste trabalho, onde inicialmente foram apresentados os tipos de restrições existentes em processos industriais. Em seguida, foi apresentada uma breve introdução sobre o controle clássico e o controle moderno, dando uma ênfase maior aos sistemas lineares em equação de estados, o conceito de conjunto positivamente invariante, e a sua contribuição em sistemas de controle. Neste mesmo capítulo foi abordada a contribuição da teoria de conjuntos invariantes em sistemas de controle sujeitos a restrições, com base no artigo descrito por~\citeasnoun{Dorea:1999}, que apresentou as definições fundamentais que caracterizam um conjunto poliédrico invariante controlado. Na sequência foi mostrado que a partir de um conjunto de restrições é possível encontrar um máximo conjunto invariante controlado, garantindo, assim, que existe uma sequência de controle que mantém a dinâmica do sistema sujeita a restrições. Logo em seguida, foram apresentadas duas técnicas de otimização (LP e mp-LP), que podem ser utilizadas para projetos de controle de sistemas lineares sujeitos a restrições. Por fim, foram abordadas as desvantagens destas técnicas em projetos de controle, quando se trata do elevado tempo computacional da solução \textit{on-line} e a capacidade de memória exigida pelo número de regiões resultantes da solução \textit{off-line}. 

Recentemente, vários estudos estão sendo realizados com intuito de encontrar soluções explicitas por meios de diferentes métodos~\cite{Zeilinger:2011}. A partir disso, o capítulo a seguir apresentará uma técnica que pode ser aplicada para calcular leis de controle PWA e subdividir o conjunto de restrições em um número menor de regiões viáveis e, consequentemente, reduzir os custos computacionais mencionados neste capítulo.










%%\subsection{Sensores tolerantes a falhas} 
%
%%\begin{figure}[H]
  %%\begin{center}
  %%\includegraphics[scale=0.95]{imagens/etapasdiagn.png}
  %%\end{center}
  %%\caption{Etapas diagnóstico de falhas.}
  %%\label{Fig:etapasdiagn}
%%\end{figure}
